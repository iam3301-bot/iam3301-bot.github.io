<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å¼ºåˆ¶åˆ·æ–°å·¥å…·</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }
    
    .container {
      background: white;
      border-radius: 20px;
      padding: 40px;
      max-width: 600px;
      width: 100%;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
      text-align: center;
    }
    
    h1 {
      color: #f5576c;
      margin-bottom: 20px;
      font-size: 36px;
    }
    
    .subtitle {
      color: #666;
      margin-bottom: 30px;
      font-size: 18px;
      line-height: 1.6;
    }
    
    .btn {
      background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
      color: white;
      border: none;
      padding: 20px 40px;
      border-radius: 12px;
      font-size: 20px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
      margin: 10px;
      box-shadow: 0 5px 20px rgba(245,87,108,0.3);
    }
    
    .btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 30px rgba(245,87,108,0.5);
    }
    
    .status {
      margin-top: 30px;
      padding: 20px;
      border-radius: 12px;
      font-size: 16px;
      line-height: 1.8;
    }
    
    .status.success {
      background: #d4edda;
      border: 2px solid #28a745;
      color: #155724;
    }
    
    .status.error {
      background: #f8d7da;
      border: 2px solid #dc3545;
      color: #721c24;
    }
    
    .status.info {
      background: #d1ecf1;
      border: 2px solid #17a2b8;
      color: #0c5460;
    }
    
    .countdown {
      font-size: 48px;
      font-weight: bold;
      color: #f5576c;
      margin: 20px 0;
    }
    
    .note {
      background: #fff3cd;
      border: 2px solid #ffc107;
      color: #856404;
      padding: 15px;
      border-radius: 8px;
      margin: 20px 0;
      text-align: left;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸ”„ å¼ºåˆ¶åˆ·æ–°å·¥å…·</h1>
    <p class="subtitle">
      ä¸€é”®æ¸…é™¤ç¼“å­˜å¹¶é‡æ–°åŠ è½½ç¤¾åŒºé¡µé¢<br>
      è§£å†³"æœ¬åœ°å­˜å‚¨æ•°æ®"é—®é¢˜
    </p>
    
    <button class="btn" onclick="clearAndRefresh()">
      ğŸš€ æ¸…é™¤ç¼“å­˜å¹¶åˆ·æ–°
    </button>
    
    <button class="btn" onclick="openCommunity()">
      ğŸ“± æ‰“å¼€ç¤¾åŒºé¡µé¢
    </button>
    
    <div id="status" style="display: none;"></div>
    
    <div class="note">
      <strong>ğŸ’¡ è¿™ä¸ªå·¥å…·ä¼šåšä»€ä¹ˆï¼Ÿ</strong><br>
      1. æ¸…é™¤ community.html çš„æ‰€æœ‰ç¼“å­˜<br>
      2. æ¸…é™¤ç›¸å…³ JavaScript æ–‡ä»¶ç¼“å­˜<br>
      3. æ¸…é™¤ localStorage æ•°æ®<br>
      4. é‡æ–°åŠ è½½é¡µé¢
    </div>
  </div>

  <script>
    function clearAndRefresh() {
      const status = document.getElementById('status');
      status.style.display = 'block';
      status.className = 'status info';
      status.innerHTML = 'ğŸ”„ æ­£åœ¨æ¸…é™¤ç¼“å­˜...<br><br>';
      
      let step = 1;
      
      // æ­¥éª¤1: æ¸…é™¤ localStorage
      setTimeout(() => {
        try {
          localStorage.clear();
          sessionStorage.clear();
          status.innerHTML += `âœ… æ­¥éª¤ ${step++}: localStorage å·²æ¸…é™¤<br>`;
        } catch (e) {
          status.innerHTML += `âš ï¸ æ­¥éª¤ ${step++}: localStorage æ¸…é™¤å¤±è´¥<br>`;
        }
        
        // æ­¥éª¤2: æ¸…é™¤ Service Worker
        setTimeout(() => {
          if ('serviceWorker' in navigator) {
            navigator.serviceWorker.getRegistrations().then(registrations => {
              registrations.forEach(reg => reg.unregister());
              status.innerHTML += `âœ… æ­¥éª¤ ${step++}: Service Worker å·²æ¸…é™¤<br>`;
            });
          } else {
            status.innerHTML += `â„¹ï¸ æ­¥éª¤ ${step++}: æ—  Service Worker<br>`;
          }
          
          // æ­¥éª¤3: æ¸…é™¤ Cache API
          setTimeout(() => {
            if ('caches' in window) {
              caches.keys().then(names => {
                names.forEach(name => caches.delete(name));
                status.innerHTML += `âœ… æ­¥éª¤ ${step++}: Cache API å·²æ¸…é™¤<br>`;
              });
            } else {
              status.innerHTML += `â„¹ï¸ æ­¥éª¤ ${step++}: æ—  Cache API<br>`;
            }
            
            // æ­¥éª¤4: å€’è®¡æ—¶è·³è½¬
            setTimeout(() => {
              status.innerHTML += `<br>âœ… æ‰€æœ‰ç¼“å­˜å·²æ¸…é™¤ï¼<br><br>`;
              let countdown = 3;
              status.innerHTML += `<div class="countdown">${countdown}</div>`;
              status.innerHTML += `ç§’åè‡ªåŠ¨è·³è½¬åˆ°ç¤¾åŒºé¡µé¢...`;
              
              const timer = setInterval(() => {
                countdown--;
                if (countdown > 0) {
                  document.querySelector('.countdown').textContent = countdown;
                } else {
                  clearInterval(timer);
                  // ä½¿ç”¨æ—¶é—´æˆ³å¼ºåˆ¶åˆ·æ–°
                  window.location.href = `community.html?t=${Date.now()}`;
                }
              }, 1000);
            }, 500);
          }, 500);
        }, 500);
      }, 500);
    }
    
    function openCommunity() {
      // ä½¿ç”¨æ—¶é—´æˆ³å¼ºåˆ¶ä¸ç¼“å­˜
      window.location.href = `community.html?t=${Date.now()}`;
    }
  </script>
</body>
</html>
