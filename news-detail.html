<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <title>GameBox æ¸¸ç›’ - èµ„è®¯è¯¦æƒ…</title>
  <!-- Cyberpunk Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700;900&family=Rajdhani:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="index.css" />
  <style>
    /* èµ„è®¯è¯¦æƒ…é¡µä¸“å±æ ·å¼ */
    .news-header-info {
      display: flex;
      align-items: center;
      gap: 20px;
      margin-bottom: 20px;
      padding-bottom: 20px;
      border-bottom: 2px solid rgba(255, 211, 0, 0.2);
    }
    
    .news-icon-large {
      width: 80px;
      height: 80px;
      border-radius: 12px;
      background: linear-gradient(135deg, rgba(85, 234, 212, 0.2), rgba(255, 61, 148, 0.2));
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 40px;
      flex-shrink: 0;
      border: 2px solid rgba(85, 234, 212, 0.3);
      box-shadow: 0 0 20px rgba(85, 234, 212, 0.2);
    }
    
    .news-meta-info {
      flex: 1;
    }
    
    .news-type-badge {
      display: inline-block;
      padding: 4px 12px;
      background: linear-gradient(135deg, rgba(255, 211, 0, 0.2), rgba(255, 61, 148, 0.1));
      border: 1px solid var(--cyber-yellow);
      border-radius: 4px;
      color: var(--cyber-yellow);
      font-size: 11px;
      font-weight: 700;
      margin-bottom: 8px;
    }
    
    .news-meta-items {
      display: flex;
      gap: 16px;
      flex-wrap: wrap;
      font-size: 12px;
      color: var(--text-muted);
    }
    
    .news-meta-item {
      display: flex;
      align-items: center;
      gap: 4px;
    }
    
    .news-content-area {
      font-size: 14px;
      color: var(--text-soft);
      line-height: 1.8;
      margin: 24px 0;
    }
    
    .news-content-area h3 {
      font-size: 18px;
      color: var(--cyber-yellow);
      margin: 24px 0 12px;
      font-weight: 700;
    }
    
    .news-content-area h4 {
      font-size: 16px;
      color: var(--cyber-cyan);
      margin: 20px 0 10px;
      font-weight: 600;
    }
    
    .news-content-area p {
      margin-bottom: 14px;
      text-align: justify;
    }
    
    .news-content-area ul,
    .news-content-area ol {
      padding-left: 24px;
      margin-bottom: 14px;
    }
    
    .news-content-area li {
      margin-bottom: 8px;
    }
    
    .news-content-area strong {
      color: var(--cyber-yellow);
      font-weight: 600;
    }
    
    .news-actions {
      display: flex;
      gap: 12px;
      margin: 24px 0;
      padding: 16px;
      background: rgba(0, 0, 0, 0.3);
      border-radius: 8px;
    }
    
    .action-btn {
      display: flex;
      align-items: center;
      gap: 6px;
      padding: 10px 20px;
      background: rgba(85, 234, 212, 0.1);
      border: 1px solid rgba(85, 234, 212, 0.3);
      border-radius: 4px;
      color: var(--text-main);
      font-size: 13px;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    
    .action-btn:hover {
      background: rgba(85, 234, 212, 0.2);
      border-color: var(--cyber-cyan);
      box-shadow: 0 0 15px rgba(85, 234, 212, 0.3);
    }
    
    .action-btn.active {
      background: linear-gradient(135deg, rgba(85, 234, 212, 0.3), rgba(0, 255, 159, 0.2));
      border-color: var(--cyber-cyan);
      color: var(--cyber-cyan);
    }
    
    .related-news {
      background: rgba(0, 0, 0, 0.3);
      border: 1px solid rgba(85, 234, 212, 0.2);
      border-radius: 8px;
      padding: 12px;
      margin-bottom: 10px;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    
    .related-news:hover {
      border-color: rgba(85, 234, 212, 0.4);
      transform: translateX(3px);
      background: rgba(85, 234, 212, 0.05);
    }
    
    .related-news-title {
      font-size: 13px;
      color: var(--text-main);
      margin-bottom: 4px;
      font-weight: 600;
    }
    
    .related-news-meta {
      font-size: 11px;
      color: var(--text-muted);
    }
  </style>
</head>
<body data-current-page="news">
<div class="page">
  <header class="header">
    <div class="header-inner">
      <a href="index.html" class="logo">
        <div class="logo-mark">G</div>
        <div>
          <div>GameBox æ¸¸ç›’</div>
          <div class="logo-sub">LIGHTWEIGHT GAME HUB</div>
        </div>
      </a>
      <nav class="nav-main">
        <a href="index.html" data-page="home" class="nav-link">é¦–é¡µ</a>
        <a href="game-library.html" data-page="library" class="nav-link">æ¸¸æˆåº“</a>
        <a href="ranking.html" data-page="ranking" class="nav-link">
          æ’è¡Œæ¦œ <span class="badge">HOT</span>
        </a>
        <a href="discount.html" data-page="discount" class="nav-link">æŠ˜æ‰£ / å²ä½</a>
        <a href="community.html" data-page="community" class="nav-link">ç¤¾åŒº</a>
        <a href="news-list.html" data-page="news" class="nav-link">èµ„è®¯</a>
        <a href="tools.html" data-page="tools" class="nav-link">å·¥å…·</a>
        <a href="my-library.html" data-page="my" class="nav-link">æˆ‘çš„æ¸¸æˆ</a>
        <a href="profile.html" data-page="profile" class="nav-link">ç”¨æˆ·ä¸­å¿ƒ</a>
      </nav>
      <div class="header-right">
        <div class="header-search">
          <input type="text" placeholder="æœç´¢æ¸¸æˆ / èµ„è®¯ / å¸–å­" />
          <span class="header-search-icon">ğŸ”</span>
        </div>
        <button class="header-user" onclick="window.location.href='profile.html';" style="cursor: pointer;">æœªç™»å½• Â· æ¸¸å®¢</button>
      </div>
    </div>
  </header>
  
  <!-- Cyberpunk Effects -->
  <canvas id="matrix-canvas" class="matrix-bg"></canvas>
  <div id="particles-container" class="particles-container"></div>
  <div id="scroll-progress" class="scroll-progress"></div>
  <div id="loading-overlay" class="loading-overlay">
    <div class="cyberpunk-loader">
      <div class="loader-hexagon"></div>
      <div class="loader-text">LOADING...</div>
    </div>
  </div>

  <main class="main">
    <section>
      <article class="card">
        <div class="page-title" id="newsTitle">åŠ è½½ä¸­...</div>
        
        <div class="news-header-info">
          <div class="news-icon-large" id="newsIcon">ğŸ“°</div>
          <div class="news-meta-info">
            <div class="news-type-badge" id="newsType">èµ„è®¯</div>
            <div class="news-meta-items">
              <span class="news-meta-item">ğŸ® <span id="newsGame">--</span></span>
              <span class="news-meta-item">ğŸ“… <span id="newsDate">--</span></span>
              <span class="news-meta-item">ğŸ‘ï¸ <span id="newsViews">--</span> æµè§ˆ</span>
              <span class="news-meta-item">ğŸ’¬ <span id="newsComments">--</span> è¯„è®º</span>
            </div>
          </div>
        </div>
        
        <div class="news-content-area" id="newsContent">
          <p>æ­£åœ¨åŠ è½½èµ„è®¯å†…å®¹...</p>
        </div>
        
        <div class="news-actions">
          <button class="action-btn" id="btnLike">
            <span>ğŸ‘</span>
            <span id="likeText">ç‚¹èµ</span>
          </button>
          <button class="action-btn" id="btnFavorite">
            <span>â­</span>
            <span>æ”¶è—</span>
          </button>
          <button class="action-btn" id="btnShare">
            <span>ğŸ”—</span>
            <span>åˆ†äº«</span>
          </button>
        </div>
      </article>
    </section>

    <aside>
      <div class="sidebar-card">
        <div class="sidebar-title">ğŸ”™ è¿”å›</div>
        <div class="sidebar-item">
          <span class="label">èµ„è®¯åˆ—è¡¨</span>
          <span class="value"><a href="news-list.html">è¿”å›åˆ—è¡¨</a></span>
        </div>
      </div>
      
      <div class="sidebar-card" style="margin-top: 16px;">
        <div class="sidebar-title">ğŸ“Š èµ„è®¯ä¿¡æ¯</div>
        <div class="sidebar-item">
          <span class="label">æ¸¸æˆ</span>
          <span class="value" id="sidebarGame">--</span>
        </div>
        <div class="sidebar-item">
          <span class="label">ç±»å‹</span>
          <span class="value" id="sidebarType">--</span>
        </div>
        <div class="sidebar-item">
          <span class="label">å‘å¸ƒæ—¥æœŸ</span>
          <span class="value" id="sidebarDate">--</span>
        </div>
        <div class="sidebar-item">
          <span class="label">æµè§ˆæ¬¡æ•°</span>
          <span class="value" id="sidebarViews">--</span>
        </div>
      </div>
      
      <div class="sidebar-card" style="margin-top: 16px;">
        <div class="sidebar-title">ğŸ”— ç›¸å…³èµ„è®¯</div>
        <div id="relatedNews"></div>
      </div>
    </aside>
  </main>
</div>

<script src="common.js"></script>
<script src="cyber-effects.js"></script>
<script src="game-cover-fetcher.js"></script>
<script src="news-api.js"></script>
<script src="real-news-api.js"></script>
<script>
  initCommon();
  
  // ä½¿ç”¨çœŸå®API
  const USE_REAL_API = true;

  // ç±»å‹å›¾æ ‡å’Œåç§°æ˜ å°„
  const typeIcons = {
    'update': 'ğŸ”„',
    'new': 'ğŸ®',
    'event': 'ğŸ‰'
  };
  
  const typeNames = {
    'update': 'æ›´æ–°/ç‰ˆæœ¬',
    'new': 'æ–°ä½œ/å‘å”®',
    'event': 'æ´»åŠ¨/èµ›äº‹'
  };
  
  // ä½¿ç”¨æ™ºèƒ½æ¸¸æˆå°é¢è·å–ç³»ç»Ÿ
  const gameCoverFetcher = window.gameCoverFetcher;
  
  // æ¸¸æˆå›¾æ ‡æ˜ å°„ï¼ˆä½œä¸ºå¤‡ç”¨ï¼‰
  const gameIcons = {
    'è‰¾å°”ç™»æ³•ç¯': 'âš”ï¸',
    'èµ›åšæœ‹å…‹2077': 'ğŸŒƒ',
    'åŸç¥': 'âš¡',
    'å¡å°”è¾¾ä¼ è¯´': 'ğŸ—¡ï¸',
    'GTA 6': 'ğŸš—',
    'åšå¾·ä¹‹é—¨3': 'ğŸ²',
    'æ˜Ÿç©º': 'ğŸŒŒ',
    'æˆ˜ç¥': 'ğŸ†',
    'åªç‹¼': 'ğŸ¥·',
    'ç©ºæ´éª‘å£«': 'ğŸª²'
  };

  // è·å–URLå‚æ•°
  const urlParams = new URLSearchParams(window.location.search);
  const newsId = urlParams.get('id');
  
  let currentNews = null;
  let allNews = [];

  // ç”Ÿæˆè¯¦ç»†å†…å®¹
  function generateDetailContent(news, gameCover) {
    // ä½¿ç”¨æ¸¸æˆå°é¢ä½œä¸ºè¯¦æƒ…é¡µæˆªå›¾
    let screenshots = '';
    if (gameCover) {
      screenshots = `
        <div style="margin: 20px 0; text-align: center;">
          <img src="${gameCover}" alt="${news.game} æ¸¸æˆç”»é¢" style="width: 100%; max-width: 800px; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.3);" onerror="this.parentElement.style.display='none';" />
          <p style="margin-top: 8px; font-size: 12px; color: var(--text-muted);">ã€Š${news.game}ã€‹æ¸¸æˆç”»é¢</p>
        </div>
      `;
    }
    
    const templates = {
      'update': `
        <h3>ğŸ“‹ æ›´æ–°æ¦‚è¦</h3>
        <p>æœ¬æ¬¡æ›´æ–°ä¸ºã€Š${news.game}ã€‹å¸¦æ¥äº†é‡è¦çš„æ”¹è¿›å’Œä¼˜åŒ–ã€‚${news.summary}</p>
        
        ${screenshots}
        
        <h4>ğŸ”§ ä¸»è¦æ›´æ–°å†…å®¹</h4>
        <ul>
          <li><strong>æ¸¸æˆå¹³è¡¡æ€§è°ƒæ•´</strong>ï¼šå¯¹éƒ¨åˆ†è§’è‰²/æ­¦å™¨/æŠ€èƒ½è¿›è¡Œäº†å¹³è¡¡æ€§ä¼˜åŒ–</li>
          <li><strong>Bugä¿®å¤</strong>ï¼šä¿®å¤äº†è‹¥å¹²å½±å“æ¸¸æˆä½“éªŒçš„å·²çŸ¥é—®é¢˜</li>
          <li><strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼šæå‡äº†æ¸¸æˆåœ¨å„å¹³å°ä¸Šçš„è¿è¡Œè¡¨ç°</li>
          <li><strong>æ–°å¢å†…å®¹</strong>ï¼šåŠ å…¥äº†æ–°çš„æ¸¸æˆå…ƒç´ å’ŒåŠŸèƒ½</li>
        </ul>
        
        <h4>ğŸ¯ é‡ç‚¹æ”¹åŠ¨</h4>
        <p>å¼€å‘å›¢é˜Ÿç‰¹åˆ«å…³æ³¨äº†ç©å®¶ç¤¾åŒºçš„åé¦ˆï¼Œé’ˆå¯¹æ€§åœ°æ”¹è¿›äº†ä»¥ä¸‹æ–¹é¢ï¼š</p>
        <ol>
          <li>ä¼˜åŒ–äº†ç”¨æˆ·ç•Œé¢ï¼Œæå‡æ“ä½œä¾¿åˆ©æ€§</li>
          <li>åŠ å¼ºäº†ç½‘ç»œè¿æ¥ç¨³å®šæ€§</li>
          <li>æ”¹è¿›äº†åŒ¹é…æœºåˆ¶ç®—æ³•</li>
          <li>å®Œå–„äº†æ–°æ‰‹å¼•å¯¼ç³»ç»Ÿ</li>
        </ol>
        
        <h4>ğŸ“¢ å¼€å‘è€…ç•™è¨€</h4>
        <p>æˆ‘ä»¬ä¼šæŒç»­å…³æ³¨ç©å®¶çš„æ„è§å’Œå»ºè®®ï¼Œä¸æ–­æ”¹è¿›æ¸¸æˆä½“éªŒã€‚æ„Ÿè°¢å„ä½ç©å®¶çš„æ”¯æŒï¼</p>
        
        <p><strong>æ›´æ–°æ—¶é—´ï¼š</strong>${news.date}<br>
        <strong>æ›´æ–°å¤§å°ï¼š</strong>çº¦ ${Math.floor(Math.random() * 5 + 1)}GB<br>
        <strong>é€‚ç”¨å¹³å°ï¼š</strong>PC / PlayStation / Xbox / Switch</p>
      `,
      
      'new': `
        <h3>ğŸ® æ¸¸æˆä»‹ç»</h3>
        <p>${news.summary} ã€Š${news.game}ã€‹å³å°†ä¸ºç©å®¶å¸¦æ¥å…¨æ–°çš„æ¸¸æˆä½“éªŒã€‚</p>
        
        ${screenshots}
        
        <h4>âœ¨ æ¸¸æˆç‰¹è‰²</h4>
        <ul>
          <li><strong>éœ‡æ’¼ç”»é¢</strong>ï¼šé‡‡ç”¨æœ€æ–°æ¸¸æˆå¼•æ“ï¼Œæ‰“é€ ç”µå½±çº§è§†è§‰æ•ˆæœ</li>
          <li><strong>æ·±åº¦å‰§æƒ…</strong>ï¼šç²¾å¿ƒç¼–å†™çš„æ•…äº‹çº¿ï¼Œå¸¦æ¥æ²‰æµ¸å¼ä½“éªŒ</li>
          <li><strong>ä¸°å¯Œç©æ³•</strong>ï¼šå¤šæ ·åŒ–çš„æ¸¸æˆæœºåˆ¶ï¼Œå¯ç©æ€§æé«˜</li>
          <li><strong>å¼€æ”¾ä¸–ç•Œ</strong>ï¼šå¹¿é˜”çš„æ¢ç´¢ç©ºé—´ï¼Œè‡ªç”±åº¦æé«˜</li>
        </ul>
        
        <h4>ğŸ¯ æ ¸å¿ƒç©æ³•</h4>
        <p>æ¸¸æˆæä¾›äº†å¤šç§æ¸¸æˆæ¨¡å¼ä¾›ç©å®¶é€‰æ‹©ï¼š</p>
        <ol>
          <li><strong>å‰§æƒ…æ¨¡å¼</strong>ï¼šè·Ÿéšä¸»çº¿å‰§æƒ…ï¼Œä½“éªŒå®Œæ•´æ•…äº‹</li>
          <li><strong>è‡ªç”±æ¢ç´¢</strong>ï¼šåœ¨å¼€æ”¾ä¸–ç•Œä¸­è‡ªç”±å†’é™©</li>
          <li><strong>å¤šäººåˆä½œ</strong>ï¼šä¸å¥½å‹ç»„é˜Ÿå…±åŒæŒ‘æˆ˜</li>
          <li><strong>ç«æŠ€å¯¹æˆ˜</strong>ï¼šä¸å…¶ä»–ç©å®¶ä¸€è¾ƒé«˜ä¸‹</li>
        </ol>
        
        <h4>ğŸ“… å‘å”®ä¿¡æ¯</h4>
        <p><strong>å‘å”®æ—¥æœŸï¼š</strong>${news.date}<br>
        <strong>é¦–å‘å¹³å°ï¼š</strong>PC / PlayStation 5 / Xbox Series X|S<br>
        <strong>é¢„è®¡ä»·æ ¼ï¼š</strong>Â¥298 - Â¥498<br>
        <strong>æ”¯æŒè¯­è¨€ï¼š</strong>ä¸­æ–‡ / è‹±æ–‡ / æ—¥æ–‡ç­‰å¤šè¯­è¨€</p>
        
        <h4>ğŸ é¢„è´­å¥–åŠ±</h4>
        <p>ç°åœ¨é¢„è´­å¯è·å¾—ç‹¬å®¶é™å®šå†…å®¹ï¼š</p>
        <ul>
          <li>é™å®šè§’è‰²çš®è‚¤</li>
          <li>ç‰¹æ®Šæ­¦å™¨åŒ…</li>
          <li>æ¸¸æˆåŸå£°éŸ³ä¹</li>
          <li>æ•°å­—è‰ºæœ¯è®¾å®šé›†</li>
        </ul>
      `,
      
      'event': `
        <h3>ğŸ‰ æ´»åŠ¨è¯¦æƒ…</h3>
        <p>${news.summary} è¿™æ˜¯ä¸€æ¬¡ä¸å®¹é”™è¿‡çš„ç²¾å½©æ´»åŠ¨ï¼</p>
        
        ${screenshots}
        
        <h4>ğŸ“‹ æ´»åŠ¨å†…å®¹</h4>
        <ul>
          <li><strong>æ´»åŠ¨ä¸»é¢˜</strong>ï¼š${news.game} ç‰¹åˆ«æ´»åŠ¨</li>
          <li><strong>æ´»åŠ¨æ—¶é—´</strong>ï¼š${news.date} èµ·ï¼ŒæŒç»­14å¤©</li>
          <li><strong>å‚ä¸æ–¹å¼</strong>ï¼šç™»å½•æ¸¸æˆå³å¯è‡ªåŠ¨å‚ä¸</li>
          <li><strong>å¥–åŠ±ä¸°åš</strong>ï¼šå®Œæˆä»»åŠ¡å¯è·å¾—é™å®šé“å…·</li>
        </ul>
        
        <h4>ğŸ æ´»åŠ¨å¥–åŠ±</h4>
        <p>å‚ä¸æ´»åŠ¨å¯è·å¾—ä»¥ä¸‹å¥–åŠ±ï¼š</p>
        <ol>
          <li><strong>é™å®šçš®è‚¤</strong>ï¼šæ´»åŠ¨ä¸“å±å¤–è§‚ï¼Œä»…æ­¤æœŸé—´å¯è·å¾—</li>
          <li><strong>æ¸¸æˆè´§å¸</strong>ï¼šå¤§é‡æ¸¸æˆå†…è´§å¸å¥–åŠ±</li>
          <li><strong>ç‰¹æ®Šç§°å·</strong>ï¼šå½°æ˜¾ç©å®¶è£èª‰çš„é™å®šç§°å·</li>
          <li><strong>ç¨€æœ‰é“å…·</strong>ï¼šæå‡æ¸¸æˆä½“éªŒçš„çè´µç‰©å“</li>
        </ol>
        
        <h4>ğŸ“œ ä»»åŠ¡è¦æ±‚</h4>
        <ul>
          <li>å®Œæˆæ¯æ—¥ç­¾åˆ°ä»»åŠ¡</li>
          <li>è¾¾æˆæŒ‡å®šæ¸¸æˆç›®æ ‡</li>
          <li>å‚ä¸ç¤¾åŒºäº’åŠ¨æ´»åŠ¨</li>
          <li>é‚€è¯·å¥½å‹ä¸€èµ·æ¸¸ç©</li>
        </ul>
        
        <h4>âš ï¸ æ³¨æ„äº‹é¡¹</h4>
        <p>â€¢ æ´»åŠ¨æœŸé—´é™å®šï¼Œé€¾æœŸå¥–åŠ±æ— æ³•é¢†å–<br>
        â€¢ éƒ¨åˆ†å¥–åŠ±éœ€è¦å®Œæˆç‰¹å®šä»»åŠ¡æ‰èƒ½è§£é”<br>
        â€¢ è¯·åŠæ—¶å…³æ³¨å®˜æ–¹å…¬å‘Šï¼Œäº†è§£æœ€æ–°æ´»åŠ¨åŠ¨æ€<br>
        â€¢ æ´»åŠ¨æœ€ç»ˆè§£é‡Šæƒå½’æ¸¸æˆå¼€å‘å•†æ‰€æœ‰</p>
      `
    };
    
    return templates[news.type] || `<p>${news.summary}</p>`;
  }

  // åŠ è½½èµ„è®¯è¯¦æƒ…
  async function loadNewsDetail() {
    try {
      if (!newsId) {
        throw new Error('æœªæŒ‡å®šèµ„è®¯ID');
      }
      
      // åŠ è½½æ‰€æœ‰èµ„è®¯ï¼ˆä¼˜å…ˆä½¿ç”¨çœŸå®APIï¼‰
      if (USE_REAL_API && window.realNewsAPI) {
        allNews = await window.realNewsAPI.getAllRealNews();
        
        // å¦‚æœçœŸå®APIæ•°æ®ä¸è¶³ï¼Œè¡¥å……å¤‡ç”¨æ•°æ®
        if (allNews.length < 10) {
          const fallbackData = await window.newsAPI.getAllNews();
          allNews = allNews.concat(fallbackData.slice(0, 50));
        }
      } else {
        allNews = await window.newsAPI.getAllNews();
      }
      
      // æŸ¥æ‰¾å¯¹åº”èµ„è®¯
      currentNews = allNews.find(n => n.id === newsId);
      
      if (!currentNews) {
        throw new Error('æœªæ‰¾åˆ°å¯¹åº”èµ„è®¯');
      }
      
      // æ¸²æŸ“èµ„è®¯å†…å®¹
      renderNews();
      
      // æ¸²æŸ“ç›¸å…³èµ„è®¯
      renderRelatedNews();
      
    } catch (err) {
      console.error('åŠ è½½èµ„è®¯å¤±è´¥:', err);
      document.getElementById('newsTitle').textContent = 'èµ„è®¯åŠ è½½å¤±è´¥';
      document.getElementById('newsContent').innerHTML = `
        <div style="text-align: center; color: var(--danger); padding: 40px;">
          âŒ ${err.message}<br>
          <a href="news-list.html" style="color: var(--cyber-cyan); margin-top: 16px; display: inline-block;">è¿”å›èµ„è®¯åˆ—è¡¨</a>
        </div>
      `;
    }
  }

  // æ¸²æŸ“èµ„è®¯å†…å®¹
  function renderNews() {
    const typeIcon = typeIcons[currentNews.type] || 'ğŸ“°';
    const typeName = typeNames[currentNews.type] || 'èµ„è®¯';
    const gameIcon = gameIcons[currentNews.game] || 'ğŸ®';
    
    // ä½¿ç”¨æ™ºèƒ½å°é¢è·å–ç³»ç»Ÿï¼ˆåŒæ­¥ç‰ˆæœ¬ï¼‰
    const gameCover = gameCoverFetcher.getGameCover(currentNews.game);
    
    // æ›´æ–°é¡µé¢æ ‡é¢˜
    document.title = `${currentNews.title} - GameBox æ¸¸ç›’`;
    
    // ä¸»ä½“å†…å®¹
    document.getElementById('newsTitle').textContent = currentNews.title;
    
    // è®¾ç½®å°é¢å›¾ç‰‡æˆ–å›¾æ ‡
    const newsIconEl = document.getElementById('newsIcon');
    if (gameCover) {
      newsIconEl.innerHTML = `<img src="${gameCover}" alt="${currentNews.game}" style="width:100%;height:100%;object-fit:cover;border-radius:12px;" onerror="this.parentElement.textContent='${gameIcon}';" />`;
    } else {
      newsIconEl.textContent = gameIcon;
    }
    
    document.getElementById('newsType').textContent = `${typeIcon} ${typeName}`;
    document.getElementById('newsGame').textContent = currentNews.game;
    document.getElementById('newsDate').textContent = currentNews.date;
    document.getElementById('newsViews').textContent = currentNews.views.toLocaleString();
    document.getElementById('newsComments').textContent = currentNews.comments;
    
    // ç”Ÿæˆè¯¦ç»†å†…å®¹ï¼ˆåŒ…å«æ¸¸æˆæˆªå›¾ï¼‰
    document.getElementById('newsContent').innerHTML = generateDetailContent(currentNews, gameCover);
    
    // ä¾§è¾¹æ 
    document.getElementById('sidebarGame').textContent = currentNews.game;
    document.getElementById('sidebarType').textContent = typeName;
    document.getElementById('sidebarDate').textContent = currentNews.date;
    document.getElementById('sidebarViews').textContent = currentNews.views.toLocaleString();
  }

  // æ¸²æŸ“ç›¸å…³èµ„è®¯
  function renderRelatedNews() {
    // æ‰¾åˆ°åŒæ¸¸æˆæˆ–åŒç±»å‹çš„èµ„è®¯
    const related = allNews
      .filter(n => n.id !== currentNews.id && 
                   (n.game === currentNews.game || n.type === currentNews.type))
      .slice(0, 5);
    
    const container = document.getElementById('relatedNews');
    
    if (related.length === 0) {
      container.innerHTML = '<div style="text-align:center;padding:20px;color:var(--text-muted);font-size:12px;">æš‚æ— ç›¸å…³èµ„è®¯</div>';
      return;
    }
    
    container.innerHTML = related.map(news => `
      <div class="related-news" onclick="window.location.href='news-detail.html?id=${news.id}'">
        <div class="related-news-title">${typeIcons[news.type] || 'ğŸ“°'} ${news.title.substring(0, 40)}${news.title.length > 40 ? '...' : ''}</div>
        <div class="related-news-meta">
          ğŸ® ${news.game} Â· ğŸ“… ${news.date}
        </div>
      </div>
    `).join('');
  }

  // æŒ‰é’®åŠŸèƒ½
  let liked = false;
  let favorited = false;

  document.getElementById('btnLike').addEventListener('click', function() {
    if (!liked) {
      liked = true;
      this.classList.add('active');
      document.getElementById('likeText').textContent = 'å·²ç‚¹èµ';
    } else {
      liked = false;
      this.classList.remove('active');
      document.getElementById('likeText').textContent = 'ç‚¹èµ';
    }
  });

  document.getElementById('btnFavorite').addEventListener('click', function() {
    if (!favorited) {
      favorited = true;
      this.classList.add('active');
      alert('âœ… å·²æ”¶è—åˆ°"æˆ‘çš„æ”¶è—"');
    } else {
      favorited = false;
      this.classList.remove('active');
      alert('âŒ å·²å–æ¶ˆæ”¶è—');
    }
  });

  document.getElementById('btnShare').addEventListener('click', () => {
    const url = window.location.href;
    navigator.clipboard.writeText(url).then(() => {
      alert('ğŸ”— é“¾æ¥å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼');
    }).catch(() => {
      alert('ğŸ”— åˆ†äº«é“¾æ¥ï¼š\n' + url);
    });
  });

  // åˆå§‹åŒ–
  loadNewsDetail();
</script>
</body>
</html>
