<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <title>GameBox æ¸¸ç›’ - æœç´¢ç»“æœ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- Cyberpunk Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700;900&family=Rajdhani:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="index.css" />
</head>
<body class="cyberpunk-theme">
<div class="page">
  <!-- é¡¶éƒ¨å¯¼èˆª -->
  <header class="header">
    <div class="header-inner">
      <a href="index.html" class="logo">
        <div class="logo-mark">G</div>
        <div>
          <div>GameBox æ¸¸ç›’</div>
          <div class="logo-sub">LIGHTWEIGHT GAME HUB</div>
        </div>
      </a>

      <nav class="nav-main">
        <a href="index.html" data-page="home" class="nav-link">é¦–é¡µ</a>
        <a href="news-list.html" data-page="news" class="nav-link">èµ„è®¯</a>
        <a href="game-library.html" data-page="library" class="nav-link">æ¸¸æˆåº“</a>
        <a href="ranking.html" data-page="ranking" class="nav-link">
          æ’è¡Œæ¦œ <span class="badge">HOT</span>
        </a>
        <a href="discount.html" data-page="discount" class="nav-link">æŠ˜æ‰£ / å²ä½</a>
        <a href="community.html" data-page="community" class="nav-link">ç¤¾åŒº</a>
        <a href="my-library.html" data-page="my" class="nav-link">æˆ‘çš„æ¸¸æˆ</a>
        <a href="tools.html" data-page="tools" class="nav-link">å·¥å…·ä¸­å¿ƒ</a>
        <a href="profile.html" data-page="profile" class="nav-link">ç”¨æˆ·ä¸­å¿ƒ</a>
      </nav>

      <div class="header-right">
        <div class="header-search">
          <input type="text" placeholder="æœç´¢æ¸¸æˆ / èµ„è®¯ / å¸–å­" />
          <span class="header-search-icon">ğŸ”</span>
        </div>
        <button class="header-user">æœªç™»å½• Â· æ¸¸å®¢</button>
      </div>
    </div>
  </header>

  <!-- Cyberpunk Effects -->
  <canvas id="matrix-canvas" class="matrix-bg"></canvas>
  <div id="particles-container" class="particles-container"></div>
  <div id="scroll-progress" class="scroll-progress"></div>
  <div id="loading-overlay" class="loading-overlay">
    <div class="cyberpunk-loader">
      <div class="loader-hexagon"></div>
      <div class="loader-text">LOADING...</div>
    </div>
  </div>

  <main class="main">
    <section>
      <div class="card">
        <div class="page-title">æœç´¢ç»“æœ</div>
        <div class="page-intro">
          å…³é”®è¯ï¼š<strong id="searchKeyword">ï¼ˆç©ºï¼‰</strong>
        </div>
      </div>

      <div class="card">
        <header class="card-header">
          <div class="card-title">
            <span class="dot"></span><span>æ¸¸æˆåŒ¹é…</span>
          </div>
        </header>
        <div id="searchGames"></div>
      </div>

      <div class="card">
        <header class="card-header">
          <div class="card-title">
            <span class="dot"></span><span>èµ„è®¯åŒ¹é…</span>
          </div>
        </header>
        <div id="searchNews"></div>
      </div>

      <div class="card">
        <header class="card-header">
          <div class="card-title">
            <span class="dot"></span><span>ç¤¾åŒºå¸–å­åŒ¹é…</span>
          </div>
        </header>
        <div id="searchPosts"></div>
      </div>
    </section>

    <aside>
      <div class="sidebar-card">
        <div class="sidebar-title">æç¤º</div>
        <div class="sidebar-item">
          <span class="label">é¡¶éƒ¨æœç´¢æ¡†ä¹Ÿå¯ä»¥é‡æ–°è¾“å…¥å…³é”®å­—</span>
        </div>
      </div>
    </aside>
  </main>
</div>

<script src="common.js"></script>
<script src="cyber-effects.js"></script>
<script>
  initCommon();

  // --------- æœç´¢ç´¢å¼•æ•°æ®ï¼ˆç®€åŒ–ç‰ˆï¼‰---------

  const gameIndex = [
    {
      name: "è‰¾å°”ç™»æ³•ç¯",
      desc: "é­‚ç±» å¼€æ”¾ä¸–ç•Œ FromSoftware ARPG",
      url: "game-detail.html"
    },
    {
      name: "åŸç¥",
      desc: "å¼€æ”¾ä¸–ç•Œ æŠ½å¡ PC æ‰‹æ¸¸",
      url: "game-library.html"
    },
    {
      name: "ç©ºæ´éª‘å£«",
      desc: "ç‹¬ç«‹æ¸¸æˆ ç±»é“¶æ²³æˆ˜å£«æ¶é­”åŸ",
      url: "game-library.html"
    },
    {
      name: "èµ›åšæœ‹å…‹ 2077",
      desc: "ç§‘å¹» RPG å¤œä¹‹åŸ",
      url: "game-library.html"
    },
    {
      name: "æ€ªç‰©çŒäººï¼šå´›èµ·",
      desc: "åŠ¨ä½œ ç‹©çŒ å¤šäººè”æœº",
      url: "game-library.html"
    }
  ];

  const newsIndex = [
    {
      title: "ã€Šè‰¾å°”ç™»æ³•ç¯ã€‹å¤§å‹ DLCâ€œé»„é‡‘æ ‘ä¹‹å½±â€æ›´æ–°è¯¦æƒ…",
      desc: "æ–°å¢åŒºåŸŸ Boss æ­¦å™¨ å¹³è¡¡æ€§è°ƒæ•´",
      url: "news-detail.html"
    },
    {
      title: "ç‹¬ç«‹ä½³ä½œã€Šç©ºæ´éª‘å£«ã€‹ç»­ä½œæµ‹è¯•æƒ…æŠ¥æ›å…‰",
      desc: "ä¸ä¹‹æ­Œ æ–°æ•Œäºº å…³å¡æœºåˆ¶",
      url: "news-list.html"
    },
    {
      title: "ã€Šèµ›åšæœ‹å…‹ 2077ã€‹å†åº¦ä¼˜åŒ–ï¼Œä½é…ç½®ä¹Ÿèƒ½ç¨³å®š 60 å¸§ï¼Ÿ",
      desc: "æ—§æ˜¾å¡ ä¼˜åŒ– è¡¥ä¸",
      url: "news-list.html"
    }
  ];

  const postIndex = [
    {
      title: "æ–°æ‰‹å…¥é—¨ï¼šå¦‚ä½•åœ¨ã€Šè‰¾å°”ç™»æ³•ç¯ã€‹ä¸­å°‘æ­»ä¸€ç‚¹",
      desc: "æ”»ç•¥ å—è‹¦ å°‘æ­»",
      url: "post-detail.html"
    },
    {
      title: "åˆ†äº«ä¸€ä¸‹æˆ‘ä»Šå¤©åˆ·åˆ°çš„ã€Šç©ºæ´éª‘å£«ã€‹ç¥å›¾",
      desc: "æˆªå›¾ åˆ†äº« å°å°æˆå°±",
      url: "community.html"
    },
    {
      title: "æœ€è¿‘å¤§å®¶éƒ½åœ¨ç©ä»€ä¹ˆï¼Ÿæ¥æŠ¥ä¸ªåˆ°",
      desc: "ç»¼åˆ æ°´å¸– æŠ¥åˆ°",
      url: "community.html"
    }
  ];

  // --------- æ¸²æŸ“é€»è¾‘ ---------

  const params = new URLSearchParams(window.location.search);
  const keywordRaw = (params.get("q") || "").trim();
  const keyword = keywordRaw.toLowerCase();
  document.getElementById("searchKeyword").textContent = keywordRaw || "ï¼ˆç©ºï¼‰";

  function highlight(text, kw) {
    if (!kw) return text;
    const reg = new RegExp("(" + kw.replace(/[.*+?^${}()|[\]\\]/g, "\\$&") + ")", "ig");
    return text.replace(reg, "<mark>$1</mark>");
  }

  function renderSection(list, kw, containerId, type) {
    const box = document.getElementById(containerId);
    box.innerHTML = "";

    if (!kw) {
      box.innerHTML = '<div style="font-size:12px;color:var(--text-muted);">è¯·è¾“å…¥å…³é”®å­—è¿›è¡Œæœç´¢ã€‚</div>';
      return;
    }

    const results = list.filter(item => {
      return (
        (item.name && item.name.toLowerCase().includes(kw)) ||
        (item.title && item.title.toLowerCase().includes(kw)) ||
        (item.desc && item.desc.toLowerCase().includes(kw))
      );
    });

    if (!results.length) {
      box.innerHTML = '<div style="font-size:12px;color:var(--text-muted);">æ²¡æœ‰åŒ¹é…ç»“æœã€‚</div>';
      return;
    }

    if (type === "game") {
      results.forEach(item => {
        const div = document.createElement("div");
        div.className = "game-card";
        div.innerHTML = `
          <div class="game-cover"></div>
          <div class="game-info">
            <div class="game-name">${highlight(item.name, kw)}</div>
            <div class="game-meta">${highlight(item.desc, kw)}</div>
            <div class="game-footer">
              <span class="tag">æŸ¥çœ‹è¯¦æƒ…</span>
            </div>
          </div>
        `;
        div.addEventListener("click", () => {
          window.location.href = item.url;
        });
        box.appendChild(div);
      });
    } else {
      // ç”¨ news-card é£æ ¼å±•ç¤º
      results.forEach(item => {
        const div = document.createElement("div");
        div.className = "news-card";
        const title = item.title || item.name;
        div.innerHTML = `
          <div class="news-title">${highlight(title, kw)}</div>
          <div class="news-excerpt">${highlight(item.desc || "", kw)}</div>
        `;
        div.addEventListener("click", () => {
          window.location.href = item.url;
        });
        box.appendChild(div);
      });
    }
  }

  renderSection(gameIndex, keyword, "searchGames", "game");
  renderSection(newsIndex, keyword, "searchNews", "news");
  renderSection(postIndex, keyword, "searchPosts", "post");
</script>
</body>
</html>
