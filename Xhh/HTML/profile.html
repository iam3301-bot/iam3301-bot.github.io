<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <title>GameBox æ¸¸ç›’ - ç”¨æˆ·ä¸­å¿ƒ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="../CSS/index.css" />
</head>
<body data-current-page="profile">
<div class="page">
  <header class="header">
    <div class="header-inner">
      <a href="home.html" class="logo">
        <div class="logo-mark">G</div>
        <div>
          <div>GameBox æ¸¸ç›’</div>
          <div class="logo-sub">LIGHTWEIGHT GAME HUB</div>
        </div>
      </a>
      <nav class="nav-main">
        <a href="home.html" data-page="home" class="nav-link">é¦–é¡µ</a>
        <a href="news-list.html" data-page="news" class="nav-link">èµ„è®¯</a>
        <a href="game-library.html" data-page="library" class="nav-link">æ¸¸æˆåº“</a>
        <a href="ranking.html" data-page="ranking" class="nav-link">
          æ’è¡Œæ¦œ <span class="badge">HOT</span>
        </a>
        <a href="discount.html" data-page="discount" class="nav-link">æŠ˜æ‰£ / å²ä½</a>
        <a href="community.html" data-page="community" class="nav-link">ç¤¾åŒº</a>
        <a href="my-library.html" data-page="my" class="nav-link">æˆ‘çš„æ¸¸æˆ</a>
        <a href="tools.html" data-page="tools" class="nav-link">å·¥å…·ä¸­å¿ƒ</a>
        <a href="profile.html" data-page="profile" class="nav-link">ç”¨æˆ·ä¸­å¿ƒ</a>
      </nav>
      <div class="header-right">
        <div class="header-search">
          <input type="text" placeholder="æœç´¢æ¸¸æˆ / èµ„è®¯ / å¸–å­" />
          <span class="header-search-icon">ğŸ”</span>
        </div>
        <button class="header-user">æœªç™»å½• Â· æ¸¸å®¢</button>
      </div>
    </div>
  </header>

  <main class="main">
    <section>
      <div class="card">
        <div class="page-title">ç”¨æˆ·ä¸­å¿ƒ</div>
        <div class="page-intro" id="profileIntro">
          ç®€å•å±•ç¤ºâ€œè´¦å·â€çš„æ„Ÿè§‰ï¼Œç»“åˆç™»å½•çŠ¶æ€ä¸æœ¬åœ°æ¸¸æˆè®°å½•åšä¸€ä¸ªæ±‡æ€»ã€‚
        </div>

        <div style="display:flex;gap:14px;flex-wrap:wrap;margin-top:10px;align-items:center;">
          <div style="width:64px;height:64px;border-radius:50%;
              background:linear-gradient(135deg,#4fc3f7,#7c4dff);
              box-shadow:0 0 20px rgba(56,189,248,0.6);"></div>
          <div style="flex:1;min-width:200px;font-size:13px;">
            <p>æ˜µç§°ï¼š<span id="profileName">æ¸¸å®¢ç©å®¶</span></p>
            <p>è´¦å·ç­‰çº§ï¼š<span id="profileLevel">Lv. 1</span></p>
            <p id="profileSummary" style="color:var(--text-muted);margin-top:4px;"></p>
          </div>
        </div>
      </div>

      <div class="card">
        <header class="card-header">
          <div class="card-title"><span class="dot"></span><span>æ•°æ®æ¦‚è§ˆ</span></div>
        </header>
        <div style="display:flex;flex-wrap:wrap;gap:12px;font-size:13px;">
          <div style="flex:1;min-width:140px;">
            <div class="sidebar-title">æ¸¸æˆè®°å½•</div>
            <p style="color:var(--text-muted);margin-top:4px;">
              å·²æ‹¥æœ‰æ¸¸æˆï¼š<strong id="statOwned">0</strong> æ¬¾<br />
              æƒ³ç©æ¸¸æˆï¼š<strong id="statWish">0</strong> æ¬¾
            </p>
          </div>
          <div style="flex:1;min-width:140px;">
            <div class="sidebar-title">è¯´æ˜</div>
            <p style="color:var(--text-muted);margin-top:4px;">
              ä»¥ä¸Šæ•°æ®å‡æ¥è‡ªæœ¬åœ° localStorageï¼Œæ˜¯è¯¾ç¨‹é¡¹ç›®çš„å‰ç«¯ç¤ºä¾‹ã€‚
            </p>
          </div>
        </div>
      </div>
    </section>

    <aside>
      <div class="sidebar-card">
        <div class="sidebar-title">æ“ä½œå»ºè®®</div>
        <div class="sidebar-item">
          <span class="label">ç™»å½•</span><span class="value"><a href="login.html">å»ç™»å½•é¡µ</a></span>
        </div>
        <div class="sidebar-item">
          <span class="label">æŸ¥çœ‹æ¸¸æˆ</span><span class="value"><a href="my-library.html">æˆ‘çš„æ¸¸æˆ</a></span>
        </div>
      </div>
    </aside>
  </main>
</div>

<script src="../JS/common.js"></script>
<script>
  initCommon();

  function getArray(key) {
    try {
      const raw = localStorage.getItem(key);
      if (!raw) return [];
      return JSON.parse(raw);
    } catch {
      return [];
    }
  }

  const ownedCount = getArray("ownedGames").length;
  const wishCount = getArray("wishlistGames").length;

  document.getElementById("statOwned").textContent = ownedCount;
  document.getElementById("statWish").textContent = wishCount;

  let currentUser = null;
  try {
    const raw = localStorage.getItem("currentUser");
    if (raw) currentUser = JSON.parse(raw);
  } catch {}

  const profileName = document.getElementById("profileName");
  const profileSummary = document.getElementById("profileSummary");
  const profileIntro = document.getElementById("profileIntro");

  if (currentUser) {
    const name = currentUser.nickname || currentUser.username || "ç©å®¶";
    profileName.textContent = name;
    profileIntro.innerHTML =
      `æ¬¢è¿å›æ¥ï¼Œ<strong>${name}</strong>ã€‚è¿™æ˜¯ä¸€ä¸ªç”¨äºè¯¾ç¨‹å±•ç¤ºçš„å‰ç«¯ Demo ç”¨æˆ·ä¸­å¿ƒã€‚`;
  }

  if (ownedCount === 0 && wishCount === 0) {
    profileSummary.textContent =
      "è¿˜æ²¡æœ‰è®°å½•ä»»ä½•æ¸¸æˆï¼Œå¯ä»¥å»æ¸¸æˆè¯¦æƒ…é¡µè¯•è¯•â€œæ ‡è®°ä¸ºå·²æ‹¥æœ‰ / åŠ å…¥æƒ³ç©æ¸…å•â€çš„æŒ‰é’®ã€‚";
  } else {
    const who = currentUser
      ? (currentUser.nickname || currentUser.username || "ä½ ")
      : "ä½ ";
    profileSummary.textContent =
      `${who} å½“å‰å·²è®°å½• ${ownedCount} æ¬¾å·²æ‹¥æœ‰æ¸¸æˆï¼Œ${wishCount} æ¬¾æƒ³ç©çš„æ¸¸æˆã€‚`;
  }
</script>
</body>
</html>
