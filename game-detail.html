<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>GameBox 游盒 - 游戏详情</title>
  <link rel="stylesheet" href="index.css" />
</head>
<body data-current-page="detail">
  <div class="page">
    <header class="header">
      <div class="header-inner">
        <a href="index.html" class="logo">
          <div class="logo-mark">G</div>
          <div>
            <div>GameBox 游盒</div>
            <div class="logo-sub">LIGHTWEIGHT GAME HUB</div>
          </div>
        </a>
        <nav class="nav-main">
          <a href="index.html" class="nav-link">首页</a>
          <a href="game-library.html" class="nav-link">游戏库</a>
          <a href="ranking.html" class="nav-link">排行榜</a>
        </nav>
      </div>
    </header>
    <main class="main main--single">
      <section>
        <article class="card detail-card">
          <div class="detail-header-bar">
            <div class="detail-breadcrumb">
              游戏详情 / <span id="breadcrumbName">加载中...</span>
            </div>
            <button class="btn-secondary" onclick="history.back()">← 返回上一页</button>
          </div>

          <div class="detail-hero">
            <div class="detail-hero-left">
              <div class="detail-cover-large">
                <img id="gameCover" src="" alt="游戏封面" />
              </div>
            </div>
            <div class="detail-hero-right">
              <div class="detail-title-row">
                <div class="detail-title-block">
                  <h1 id="gameTitle">游戏名称加载中...</h1>
                  <div id="gamePlatform">平台信息加载中...</div>
                </div>
                <div class="detail-score-card">
                  <div class="detail-score-label">游盒热度评分</div>
                  <div class="detail-score-main">
                    <span id="gameScore">-</span>
                    <span class="detail-score-outof">/ 10</span>
                  </div>
                  <div class="detail-score-sub">基于排行榜位置模拟</div>
                </div>
              </div>

              <div class="detail-tag-row">
                <span class="pill" id="gameTag">标签加载中...</span>
                <span class="pill pill-soft">发售：<span id="gameReleaseDate">未知</span></span>
                <span class="pill pill-soft">开发：<span id="gameDeveloper">未知</span></span>
                <span class="pill pill-soft">发行：<span id="gamePublisher">未知</span></span>
              </div>

              <p id="gameDescription">游戏简介加载中...</p>
              <div class="detail-links">
                <a id="gameUrl" href="#" target="_blank" class="detail-btn detail-btn-main">
                  <span>前往游戏官网 / 启动平台</span>
                  <span class="detail-btn-icon">↗</span>
                </a>
                <a id="gameProfileUrl" href="#" target="_blank" class="detail-btn detail-btn-ghost">
                  <span>查看 FreeToGame 详情页</span>
                  <span class="detail-btn-icon">↗</span>
                </a>
              </div>
            </div>
          </div>

          <div class="detail-info-grid">
            <!-- 基础信息 -->
            <section class="detail-section">
              <h2 class="detail-section-title">基础信息</h2>
              <div class="detail-meta-list">
                <div class="detail-meta-row">
                  <span class="detail-meta-label">开发商</span>
                  <span class="detail-meta-value" id="gameDeveloperMeta">未知</span>
                </div>
                <div class="detail-meta-row">
                  <span class="detail-meta-label">发行商</span>
                  <span class="detail-meta-value" id="gamePublisherMeta">未知</span>
                </div>
                <div class="detail-meta-row">
                  <span class="detail-meta-label">发售日期</span>
                  <span class="detail-meta-value" id="gameReleaseMeta">未知</span>
                </div>
                <div class="detail-meta-row">
                  <span class="detail-meta-label">平台 / 类型</span>
                  <span class="detail-meta-value" id="gamePlatformMeta">-</span>
                </div>
                <div class="detail-meta-row">
                  <span class="detail-meta-label">推荐指数</span>
                  <span class="detail-meta-value">
                    <span id="gameScoreMeta">-</span> / 10（项目内部模拟评分）
                  </span>
                </div>
              </div>
            </section>

            <!-- 系统配置 -->
            <section class="detail-section detail-section--secondary">
              <h2 class="detail-section-title">系统配置（来自 FreeToGame / Steam）</h2>
              <div class="sysreq-grid">
                <div class="sysreq-column">
                  <div class="sysreq-title">最低配置</div>
                  <ul class="sysreq-list">
                    <li><span class="sysreq-label">系统</span><span id="sysMinOs">加载中...</span></li>
                    <li><span class="sysreq-label">处理器</span><span id="sysMinCpu">加载中...</span></li>
                    <li><span class="sysreq-label">内存</span><span id="sysMinRam">加载中...</span></li>
                    <li><span class="sysreq-label">显卡</span><span id="sysMinGpu">加载中...</span></li>
                    <li><span class="sysreq-label">存储</span><span id="sysMinStorage">加载中...</span></li>
                  </ul>
                </div>

                <div class="sysreq-column sysreq-column--muted">
                  <div class="sysreq-title">推荐配置</div>
                  <div class="sysreq-placeholder">
                    FreeToGame API 当前仅提供最低配置；推荐配置暂未提供官方数据。
                    <br />本项目不虚构推荐配置，以确保数据真实可信。
                  </div>
                </div>
              </div>
            </section>
          </div>
        </article>
      </section>
    </main>
  </div>

  <script src="common.js"></script>
  <script>
    // 在页面加载时获取详情数据
    function loadDetail() {
      const params = new URLSearchParams(window.location.search);
      const gameId = params.get("id");
      const gameName = params.get("name");

      // 顶部数据
      const breadcrumbNameEl = document.getElementById("breadcrumbName");
      const titleEl = document.getElementById("gameTitle");
      const platformEl = document.getElementById("gamePlatform");
      const coverEl = document.getElementById("gameCover");
      const scoreEl = document.getElementById("gameScore");
      const devEl = document.getElementById("gameDeveloper");
      const pubEl = document.getElementById("gamePublisher");
      const dateEl = document.getElementById("gameReleaseDate");
      const tagEl = document.getElementById("gameTag");
      const descEl = document.getElementById("gameDescription");
      const gameUrlEl = document.getElementById("gameUrl");
      const profileUrlEl = document.getElementById("gameProfileUrl");

      fetch(`/ranking.json`)
        .then((response) => response.json())
        .then((data) => {
          const game = data.find((g) => g.id === gameId || g.name === gameName);
          if (!game) {
            alert("未找到游戏详情！");
            return;
          }

          breadcrumbNameEl.textContent = game.name;
          titleEl.textContent = game.name;
          platformEl.textContent = game.platform;
          coverEl.src = game.cover;
          scoreEl.textContent = game.score.toFixed(1);
          devEl.textContent = game.developer;
          pubEl.textContent = game.publisher;
          dateEl.textContent = game.releaseDate || "未知";
          tagEl.textContent = game.tag;
          descEl.textContent = game.description || "暂无简介";
          gameUrlEl.href = game.gameUrl;
          profileUrlEl.href = game.profileUrl;

          // 系统配置
          const sysMin = game.systemRequirements?.minimum || {};
          document.getElementById("sysMinOs").textContent = sysMin.os || "未知";
          document.getElementById("sysMinCpu").textContent = sysMin.processor || "未知";
          document.getElementById("sysMinRam").textContent = sysMin.memory || "未知";
          document.getElementById("sysMinGpu").textContent = sysMin.graphics || "未知";
          document.getElementById("sysMinStorage").textContent = sysMin.storage || "未知";
        })
        .catch(console.error);
    }
    loadDetail();
  </script>
</body>
</html>
