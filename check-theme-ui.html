<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>æ£€æŸ¥ä¸»é¢˜UI</title>
  <style>
    body {
      margin: 0;
      padding: 40px;
      font-family: monospace;
      background: #1a1a1a;
      color: #fff;
    }
    .info {
      background: #2a2a2a;
      padding: 20px;
      border-radius: 8px;
      margin: 20px 0;
      border-left: 4px solid #0f0;
    }
    .error {
      border-left-color: #f00;
    }
    .success {
      border-left-color: #0f0;
    }
    pre {
      background: #000;
      padding: 15px;
      border-radius: 4px;
      overflow-x: auto;
    }
    button {
      padding: 10px 20px;
      margin: 10px;
      font-size: 16px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <h1>ğŸ” GameBox ä¸»é¢˜ç³»ç»Ÿè¯Šæ–­</h1>
  
  <div id="results"></div>
  
  <div class="info">
    <h3>ğŸ“ é¢„æœŸä½ç½®</h3>
    <p>ä¸»é¢˜åˆ‡æ¢å™¨åº”è¯¥åœ¨é¡µé¢ <strong>å³ä¸‹è§’</strong></p>
    <p>ID: <code>globalThemeSwitcher</code></p>
  </div>
  
  <button onclick="runDiagnostics()">ğŸ”„ é‡æ–°æ£€æŸ¥</button>
  <button onclick="forceFindSwitcher()">ğŸ” å¼ºåˆ¶æŸ¥æ‰¾åˆ‡æ¢å™¨</button>
  <button onclick="window.location.reload()">â™»ï¸ åˆ·æ–°é¡µé¢</button>
  
  <script>
    function addResult(title, status, details) {
      const div = document.createElement('div');
      div.className = `info ${status}`;
      div.innerHTML = `
        <h3>${status === 'success' ? 'âœ…' : 'âŒ'} ${title}</h3>
        <pre>${details}</pre>
      `;
      document.getElementById('results').appendChild(div);
    }
    
    function runDiagnostics() {
      document.getElementById('results').innerHTML = '';
      
      // æ£€æŸ¥1: å…¨å±€ä¸»é¢˜ç®¡ç†å™¨
      if (window.globalThemeManager) {
        const theme = window.globalThemeManager.getCurrentTheme();
        addResult('å…¨å±€ä¸»é¢˜ç®¡ç†å™¨', 'success', 
          `å·²åŠ è½½\nå½“å‰ä¸»é¢˜: ${theme.name} ${theme.icon}\nID: ${theme.id}`);
      } else {
        addResult('å…¨å±€ä¸»é¢˜ç®¡ç†å™¨', 'error', 'æœªæ‰¾åˆ° window.globalThemeManager');
      }
      
      // æ£€æŸ¥2: DOMå…ƒç´ 
      const switcher = document.getElementById('globalThemeSwitcher');
      if (switcher) {
        const rect = switcher.getBoundingClientRect();
        addResult('ä¸»é¢˜åˆ‡æ¢å™¨DOM', 'success', 
          `å·²æ‰¾åˆ°\nä½ç½®: right=${window.innerWidth - rect.right}px, bottom=${window.innerHeight - rect.bottom}px\nå¯è§æ€§: ${getComputedStyle(switcher).display}`);
      } else {
        addResult('ä¸»é¢˜åˆ‡æ¢å™¨DOM', 'error', 'æœªæ‰¾åˆ° #globalThemeSwitcher å…ƒç´ ');
      }
      
      // æ£€æŸ¥3: æŒ‰é’®å…ƒç´ 
      const button = document.querySelector('.theme-switcher-btn');
      if (button) {
        addResult('ä¸»é¢˜æŒ‰é’®', 'success', 
          `å·²æ‰¾åˆ°\næ–‡æœ¬: ${button.textContent}\næ ·å¼: ${getComputedStyle(button).display}`);
      } else {
        addResult('ä¸»é¢˜æŒ‰é’®', 'error', 'æœªæ‰¾åˆ° .theme-switcher-btn');
      }
      
      // æ£€æŸ¥4: ä¸»é¢˜é¢æ¿
      const panel = document.querySelector('.theme-switcher-panel');
      if (panel) {
        const options = panel.querySelectorAll('.theme-option');
        addResult('ä¸»é¢˜é¢æ¿', 'success', 
          `å·²æ‰¾åˆ°\nä¸»é¢˜æ•°é‡: ${options.length}\nå½“å‰çŠ¶æ€: ${panel.classList.contains('is-active') ? 'æ˜¾ç¤º' : 'éšè—'}`);
      } else {
        addResult('ä¸»é¢˜é¢æ¿', 'error', 'æœªæ‰¾åˆ° .theme-switcher-panel');
      }
      
      // æ£€æŸ¥5: æ ·å¼æ³¨å…¥
      const styles = document.getElementById('theme-switcher-ui-styles');
      if (styles) {
        addResult('UIæ ·å¼', 'success', `å·²æ³¨å…¥\nå¤§å°: ${styles.textContent.length} å­—ç¬¦`);
      } else {
        addResult('UIæ ·å¼', 'error', 'æœªæ‰¾åˆ° #theme-switcher-ui-styles');
      }
      
      // æ£€æŸ¥6: å…¨å±€æ ·å¼
      const globalStyles = document.getElementById('global-theme-styles');
      if (globalStyles) {
        addResult('å…¨å±€æ ·å¼', 'success', `å·²æ³¨å…¥\nå¤§å°: ${globalStyles.textContent.length} å­—ç¬¦`);
      } else {
        addResult('å…¨å±€æ ·å¼', 'error', 'æœªæ‰¾åˆ° #global-theme-styles');
      }
    }
    
    function forceFindSwitcher() {
      console.log('ğŸ” æœç´¢æ‰€æœ‰ä¸»é¢˜ç›¸å…³å…ƒç´ ...');
      
      // æŸ¥æ‰¾æ‰€æœ‰åŒ…å« 'theme' çš„å…ƒç´ 
      const allElements = document.querySelectorAll('*');
      const themeElements = [];
      
      allElements.forEach(el => {
        if (el.id && (el.id.includes('theme') || el.id.includes('Theme'))) {
          themeElements.push({ type: 'ID', value: el.id, element: el });
        }
        if (el.className && (el.className.includes('theme') || el.className.includes('Theme'))) {
          themeElements.push({ type: 'Class', value: el.className, element: el });
        }
      });
      
      console.log('æ‰¾åˆ°çš„ä¸»é¢˜å…ƒç´ :', themeElements);
      
      if (themeElements.length > 0) {
        alert(`æ‰¾åˆ° ${themeElements.length} ä¸ªä¸»é¢˜ç›¸å…³å…ƒç´ ï¼Œè¯¦æƒ…è§æ§åˆ¶å°`);
      } else {
        alert('æœªæ‰¾åˆ°ä»»ä½•ä¸»é¢˜ç›¸å…³å…ƒç´ ï¼');
      }
    }
    
    // é¡µé¢åŠ è½½åè‡ªåŠ¨è¿è¡Œ
    window.addEventListener('load', () => {
      setTimeout(runDiagnostics, 1000);
    });
  </script>
  
  <!-- å…¨å±€ä¸»é¢˜ç³»ç»Ÿ -->
  <script src="global-theme-system.js"></script>
</body>
</html>
